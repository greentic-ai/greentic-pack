$schema: https://json-schema.org/draft/2020-12/schema
title: PackSpec
type: object
properties:
  annotations:
    type: object
    additionalProperties: true
    default: {}
  authors:
    type: array
    default: []
    items:
      type: string
  description:
    type:
    - string
    - 'null'
    default: null
  entry_flows:
    type: array
    default: []
    items:
      type: string
  events:
    anyOf:
    - $ref: '#/$defs/EventsSection'
    - type: 'null'
    default: null
  flow_files:
    type: array
    default: []
    items:
      type: string
  id:
    type: string
  imports_required:
    type: array
    default: []
    items:
      type: string
  kind:
    type:
    - string
    - 'null'
    default: null
  license:
    type:
    - string
    - 'null'
    default: null
  messaging:
    anyOf:
    - $ref: '#/$defs/MessagingSection'
    - type: 'null'
    default: null
  name:
    type:
    - string
    - 'null'
    default: null
  repo:
    anyOf:
    - $ref: '#/$defs/RepoPackSection'
    - type: 'null'
    default: null
  template_dirs:
    type: array
    default: []
    items:
      type: string
  version:
    type: string
required:
- id
- version
$defs:
  EventProviderCapabilities:
    type: object
    properties:
      ordering:
        anyOf:
        - $ref: '#/$defs/OrderingKind'
        - type: 'null'
      reliability:
        anyOf:
        - $ref: '#/$defs/ReliabilityKind'
        - type: 'null'
      topics:
        type: array
        items:
          type: string
      transport:
        anyOf:
        - $ref: '#/$defs/TransportKind'
        - type: 'null'
  EventProviderKind:
    type: string
    enum:
    - broker
    - source
    - sink
    - bridge
  EventProviderSpec:
    type: object
    properties:
      capabilities:
        $ref: '#/$defs/EventProviderCapabilities'
        default: {}
      component:
        type: string
      custom_flow:
        type:
        - string
        - 'null'
      default_flow:
        type:
        - string
        - 'null'
      kind:
        $ref: '#/$defs/EventProviderKind'
      name:
        type: string
    required:
    - name
    - kind
    - component
  EventsSection:
    type: object
    properties:
      providers:
        type: array
        default: []
        items:
          $ref: '#/$defs/EventProviderSpec'
  MessagingAdapter:
    type: object
    properties:
      capabilities:
        anyOf:
        - $ref: '#/$defs/MessagingAdapterCapabilities'
        - type: 'null'
      component:
        type: string
      custom_flow:
        type:
        - string
        - 'null'
      default_flow:
        type:
        - string
        - 'null'
      kind:
        $ref: '#/$defs/MessagingAdapterKind'
      name:
        type: string
    required:
    - name
    - kind
    - component
  MessagingAdapterCapabilities:
    type: object
    properties:
      direction:
        type: array
        items:
          type: string
      features:
        type: array
        items:
          type: string
    additionalProperties: false
  MessagingAdapterKind:
    type: string
    enum:
    - ingress
    - egress
    - ingress-egress
  MessagingSection:
    type: object
    properties:
      adapters:
        type:
        - array
        - 'null'
        items:
          $ref: '#/$defs/MessagingAdapter'
  OrderingKind:
    type: string
    enum:
    - none
    - per_key
    - global
  ReliabilityKind:
    type: string
    enum:
    - at_most_once
    - at_least_once
    - effectively_once
  RepoBinding:
    type: object
    properties:
      component_id:
        type: string
      profile:
        type:
        - string
        - 'null'
      world:
        type: string
    required:
    - world
    - component_id
  RepoBindings:
    type: object
    properties:
      attestation:
        type: array
        items:
          $ref: '#/$defs/RepoBinding'
      oci:
        type: array
        items:
          $ref: '#/$defs/RepoBinding'
      policy:
        type: array
        items:
          $ref: '#/$defs/RepoBinding'
      scan:
        type: array
        items:
          $ref: '#/$defs/RepoBinding'
      signing:
        type: array
        items:
          $ref: '#/$defs/RepoBinding'
      source:
        type: array
        items:
          $ref: '#/$defs/RepoBinding'
    additionalProperties: false
  RepoCapabilities:
    type: object
    properties:
      attestation:
        type: array
        items:
          type: string
      oci:
        type: array
        items:
          type: string
      policy:
        type: array
        items:
          type: string
      scan:
        type: array
        items:
          type: string
      signing:
        type: array
        items:
          type: string
      source:
        type: array
        items:
          type: string
    additionalProperties: false
  RepoPackKind:
    type: string
    enum:
    - source-provider
    - scanner
    - signing
    - attestation
    - policy-engine
    - oci-provider
  RepoPackSection:
    type: object
    properties:
      bindings:
        $ref: '#/$defs/RepoBindings'
        default: {}
      capabilities:
        $ref: '#/$defs/RepoCapabilities'
        default: {}
      kind:
        $ref: '#/$defs/RepoPackKind'
    required:
    - kind
  TransportKind:
    anyOf:
    - type: 'null'
    - type: 'null'
    - type: 'null'
    - type: 'null'
    - type: 'null'
    - type: string
